<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Panadería Navideña</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div class="header">
    <div class="header-content">
      <h1>Panel de Administración</h1>
      <div class="nav-links">
        <a href="/productos.html">Productos</a>
        <a href="/perfil.html">Mi Perfil</a>
        <button class="btn-logout" onclick="cerrarSesion()">Cerrar Sesión</button>
      </div>
    </div>
  </div>

  <div class="container">
    <h2 style="text-align: center; margin: 30px 0; color: var(--rojo-navidad); font-size: 2em;">
      Gestión de Productos
    </h2>

    <div class="form-container">
      <h3>Agregar Nuevo Producto</h3>
      <div id="mensaje"></div>

      <form id="formProducto">
        <div class="form-group">
          <label for="nombre">Nombre</label>
          <input type="text" id="nombre" required>
        </div>

        <div class="form-group">
          <label for="descripcion">Descripción</label>
          <textarea id="descripcion" rows="3" required></textarea>
        </div>

        <div class="form-group">
          <label for="precio">Precio</label>
          <input type="number" id="precio" step="0.01" min="0.01" max="999999" required>
        </div>

        <div class="form-group">
          <label for="unidad_medida">Unidad de Medida</label>
          <input type="text" id="unidad_medida" placeholder="ej: pieza, kg" required>
        </div>

        <div class="form-group">
          <label for="idcategoria">Categoría (ID)</label>
          <input type="number" id="idcategoria" value="1" min="1" required>
        </div>

        <div class="form-group">
          <label for="stock">Stock Inicial</label>
          <input type="number" id="stock" min="0" max="999999" value="0">
        </div>

        <div class="form-group">
          <label for="imagen_url">URL de la Imagen</label>
          <input type="url" id="imagen_url" placeholder="https://... (Cloudinary, S3, etc.)" autocomplete="off">
          <small style="display:block; margin-top:8px; opacity:0.8;">
            Pega una URL pública (HTTPS). Opcional.
          </small>

          <!-- Preview opcional -->
          <div style="margin-top: 12px;">
            <img id="previewImagen" alt="Preview de imagen"
              style="max-width: 220px; max-height: 220px; border-radius: 10px; display: none;" />
          </div>
        </div>

        <button type="submit" class="btn btn-primary">Agregar Producto</button>
      </form>
    </div>

    <h2 style="text-align: center; margin: 40px 0 20px; color: var(--rojo-navidad); font-size: 2em;">
      Historial de Compras
    </h2>

    <div class="tabla-admin">
      <table>
        <thead>
          <tr>
            <th>ID Pedido</th>
            <th>Fecha</th>
            <th>Cliente</th>
            <th>Correo</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody id="historialBody"></tbody>
      </table>
    </div>
  </div>

  <script>
    // ✅ Preview simple de la imagen al pegar la URL
    (function () {
      const input = document.getElementById('imagen_url');
      const img = document.getElementById('previewImagen');

      if (!input || !img) return;

      const setPreview = (url) => {
        const clean = (url || '').trim();
        if (!clean) {
          img.style.display = 'none';
          img.removeAttribute('src');
          return;
        }
        img.src = clean;
        img.style.display = 'block';
      };

      input.addEventListener('input', () => setPreview(input.value));
      input.addEventListener('change', () => setPreview(input.value));

      // Si el navegador autocompleta
      setTimeout(() => setPreview(input.value), 150);
    })();
  </script>
  <script src="/js/admin.js"></script>
</body>

</html>